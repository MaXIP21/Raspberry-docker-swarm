version: "3.1"

services:
  transmission:
    image: lscr.io/linuxserver/transmission:latest
    network_mode: "host" 
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Budapest
      - TRANSMISSION_WEB_HOME=/transmissionic/
      - USER=${admin_user} 
      - PASSWORD=${admin_password}
      - EXTERNAL_PORT=${EXTERNAL_PORT}
    ports:
      - "${EXTERNAL_PORT}:9091/tcp"
      - "51413:51413"
      - "51413:51413/udp"
    deploy:
      mode: replicated
      replicas: 1
      placement:
        constraints:
          - node.hostname == portainer-pi3
    restart: unless-stopped
    volumes:
      - /docker/transmission:/downloads
      - /docker/plex/movies:/movies
      - transmission-config:/config

volumes:
  transmission-config:
